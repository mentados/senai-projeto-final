var cartstackbr_Class=function(){var that=this;this.debug=false;var scripts=document.getElementsByTagName('script');var cartstack_found=false;for(var scriptIndex in document.scripts){var scriptSrc=xe_isset(scripts[scriptIndex].src,'string')?scripts[scriptIndex].src:false;cartstack_found=(cartstack_found||(scriptSrc&&scriptSrc.toLowerCase().indexOf('/activeapi/load.js')>-1))?true:false;}
if(!Object.entries){Object.entries=function(obj){var ownProps=Object.keys(obj),i=ownProps.length,resArray=new Array(i);while(i--)
resArray[i]=[ownProps[i],obj[ownProps[i]]];return resArray;}};if(typeof xe_getCacheTS!='function'){window.xe_getCacheTS=function(){return '';}}
this.getProc=function(){var dataLayer={newlayer:window.btoa(window.location.href.toLowerCase().split('?')[0]),cartstacktest:((-1<window.location.href.toLowerCase().indexOf('cartstacktest=true')||xe_readCookie('cs_debug')!=''||(xe_core.vm=='stage'&&xe_core.level==1))?'true':''),__utmc:'0,0',__utmz:'0',ref:'auto'};var params='?';for(var[key,value]of Object.entries(dataLayer)){if(value!=''){params=params+((params=='?')?key+'='+value:'&'+key+'='+value);}}
return 'https://app.cartstack.com.br/activeAPI/cnct/proc.js'+params;};this.init=function(){window.cartstackAPI={szEmail:'',szCartID:''};window.createCookie=function(){return window.xe_createCookie.apply(this,arguments);};window.readCookie=function(){return window.xe_readCookie.apply(this,arguments)};window.deleteCookie=function(){return window.xe_deleteCookie.apply(this,arguments);};xe_include('https://app.cartstack.com.br/activeAPI/cnct/core.js',function(data){if(data.status){xe_include(that.getProc(),function(data){if(data.status){xe_core.hookEvent(xex_visitor.events.EMAIL_INPUT,function(){var args=Array.prototype.slice.call(arguments);if(xe_core.requireExtension('lgpd')&&!xe_core.callService('cookieConsent','MARKETING,EMAIL_MARKETING')){return false;}
if(xe_isset(args[0])){for(var C=1,l=0;l<_cartstack.length;l++)
"setEmail"==_cartstack[l][0]&&(_cartstack[l][1]=args[0].email,C=0);C&&_cartstack.push(["setEmail",args[0].email]);cartstackAPI.szEmail=args[0].email;switch(cs_event){case 'capture':if(cs_pro_hit){csPROHit((cs_pro_hit===true)?undefined:cs_pro_hit);}
break;case 'checkout':cs_debug&&console.log('Email captured... sending cart...');csAPICall(cs_api_urls.cart,function(json){if(json!==false){for(var C=0,e=0;e<_cartstack.length;e++)
"setCartID"==_cartstack[e][0]&&(_cartstack[e][1]=json.cartid,C=1);0==C&&_cartstack.push(["setCartID",json.cartid]);createCookie('cartstack.com-cartid',json.cartid,365,true);cartstackAPI.szCartID=json.cartid;cs_debug&&alert(json.debug);}else
cs_debug&&console.log('CartStack: Cart API Failed!');});break;}}else
cs_debug&&console.log('CartStack: Email not changed...');});}});}});}
xe_core.hookEvent(XE_EVENTS.vars.ready,function(){if(!xe_core.requireExtension('datatunnel.js','visitor.js')){console.error('Required extensions not loaded...');}else if(cartstack_found){that.init();}});};var xex_cartstackbr=new cartstackbr_Class();